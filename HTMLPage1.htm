<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
    <script src="xml2json.js"></script>
    <script src="jquery.xdomainajax.js"></script>
    <script>
        // For This example, im going to use sample xml from o'reily for practice
        // located at url http://examples.oreilly.com/9780596002527/examples/first.xml
        // We are going to extract character name nodes for this sample
        function xmlLoader() {
            $.ajax({
                url: 'http://api.openweathermap.org/data/2.5/forecast?q=Olbia,it&mode=xml',
                dataType: "xml",
                type: 'GET',
                success: function (res) {
                    var myXML = res.responseText;
                    // This is the part xml2Json comes in.
                    //alert(myXML);
                    $('#myXMLList').empty();
                    $(myXML).find('time').each(function () {
                        var elm = $(this)
                        var from = elm.attr('from');
                        var to = elm.attr('to');
                        var windDirection = elm.find('windDirection');
                        var windDirection_deg = $(windDirection).attr('deg');

                        var windSpeed = elm.find('windSpeed');
                        var windSpeed_mps = $(windSpeed).attr('mps');

                        var clouds = elm.find('clouds');
                        var clouds_value = $(clouds).attr('value');

                        var temperature = elm.find('temperature');
                        var temperature_unit = $(temperature).attr('unit');
                        var temperature_min = $(temperature).attr('min');
                        var temperature_max = $(temperature).attr('max');
                        //alert(from + '-' + to + " windDirection_deg: " + windDirection + "-" + windDirection_deg);

                        
                        $('#myXMLList').append('<li><a href="#">' + from + to + clouds_value + '</a></li>');
                    });
                    $('#myXMLList').listview('refresh');
                    /*var JSONConvertedXML = $.xml2json(myXML);
                    alert(JSONConvertedXML);
                    $('#myXMLList').empty();
                    for (var i = 0; i < JSONConvertedXML.book.character.length; i++) {
                    $('#myXMLList').append('<li><a href="#">' + JSONConvertedXML.book.character[i].name + '</a></li>');
                    }
                    $('#myXMLList').listview('refresh');*/
                    $.mobile.hidePageLoadingMsg();
                }
            });
        }

        $(document).delegate("#home", "pageshow", function () {
            $.mobile.showPageLoadingMsg();
            xmlLoader();
        });
    </script>
</head>
<body>
    <div data-role="page" id="home">
        <div data-role="header">
            <h1>Olbia</h1>
        </div>
        <div data-role="content">
            <ul data-role="listview" data-theme="c" id="myXMLList">
            </ul>
        </div>
        <div data-role="footer">
            <a href="www.isgoodstuff.com" data-role="button">isGoodStuff.com</a>
        </div>
    </div>
</body>
</html>
