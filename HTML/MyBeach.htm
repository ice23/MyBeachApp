
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Google Maps Example</title>
     <script src='http://code.jquery.com/jquery.min.js' type='text/javascript'></script>
</head>
<body>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
    var infowindow = null;
    $(document).ready(function () { initialize(); });

    function initialize() {
        alert('inizialize Map');
        var centerMap = new google.maps.LatLng(40.931153,9.483948);

        var myOptions = {
            zoom: 11,
            center: centerMap,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }

        var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

        setMarkers(map, sites);
        infowindow = new google.maps.InfoWindow({
            content: "loading..."
        });

        var bikeLayer = new google.maps.BicyclingLayer();
        bikeLayer.setMap(map);
    }
 

    var sites = [
	['Cala Sabinasdfdsf', 41.010508, 9.585603, 4, 'Cala Sabinsdhswklnfdc jsdfmsdjfjlkds jjsfdskjn sdbfkdsf  jsdflndsjkfkd <br/> ndkfjdjfldslfa','SE'],
    ['Spiaggia Bianca', 40.990653, 9.591923, 2, 'Spiaggia Bianca.','N'],
	['Porto Istana', 40.894246,9.615097, 2, 'Porto Istana.','N'],
    ['Pittulongu', 40.938642, 9.567375, 2, 'Pittulongu.', 'N'],
	['Bados', 40.954363, 9.578104, 1, 'Bados', 'N']
];

    var imgWindOK = {
        url: '../images/face-smile-big.png',
        // This marker is 20 pixels wide by 32 pixels tall.
        size: new google.maps.Size(40, 50),
        // The origin for this image is 0,0.
        origin: new google.maps.Point(0, 0),
        // The anchor for this image is the base of the flagpole at 0,32.
        anchor: new google.maps.Point(0, 32)
    };
    var imgWindKO = {
        url: '../images/face-angry.png',
        // This marker is 20 pixels wide by 32 pixels tall.
        size: new google.maps.Size(40, 50),
        // The origin for this image is 0,0.
        origin: new google.maps.Point(0, 0),
        // The anchor for this image is the base of the flagpole at 0,32.
        anchor: new google.maps.Point(0, 32)
    };
    var shape = {
        coord: [1, 1, 1, 20, 18, 20, 18, 1],
        type: 'poly'
    };

    var WindDir = 'SE';
   
    function setMarkers(map, markers) {
        alert('markers.length:' + markers.length);
        for (var i = 0; i < markers.length; i++) {
            var sites = markers[i];
            var WindDirNo = sites[5];

            if (WindDir == WindDirNo) {
                var siteLatLng = new google.maps.LatLng(sites[1], sites[2]);

                var marker = new google.maps.Marker({
                    position: siteLatLng,
                    map: map,
                    title: sites[0],
                    zIndex: sites[3],
                    html: sites[4]
                    , icon: imgWindKO,
                    shape: shape
                });

                var contentString = "Some content";

                google.maps.event.addListener(marker, "click", function () {
                    //alert(this.html);
                    infowindow.setContent(this.html);
                    infowindow.open(map, this);
                });
            }
            else {
                var siteLatLng = new google.maps.LatLng(sites[1], sites[2]);

                var marker = new google.maps.Marker({
                    position: siteLatLng,
                    map: map,
                    title: sites[0],
                    zIndex: sites[3],
                    html: sites[4]
                    , icon: imgWindOK,
                    shape: shape
                });

                var contentString = "Some content";

                google.maps.event.addListener(marker, "click", function () {
                    //alert(this.html);
                    infowindow.setContent(this.html);
                    infowindow.open(map, this);
                });
            }

        }
    }
</script>

<div id="map_canvas" style="width: 600px; height: 600px;"></div>
</body>
</html>